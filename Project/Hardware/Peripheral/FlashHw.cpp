///////////////////////////////////////////////////////////////////////////////
//////////////////////////////// INCLUDES /////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

#include "esp_err.h"
#include "FlashHw.h"
#include "LoggerHw.h"
#include "nvs_flash.h"

///////////////////////////////////////////////////////////////////////////////
//////////////////////////////// FUNCTIONS ////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

FlashHw::FlashHw ()
{
    LOG (MODULE, "Init.");
    
    esp_err_t flashInitErr = nvs_flash_init ();
    if (flashInitErr == ESP_ERR_NVS_NO_FREE_PAGES)
    {
        ESP_ERROR_CHECK (nvs_flash_erase ());
        flashInitErr = nvs_flash_init();
    }
    
    ESP_ERROR_CHECK (flashInitErr);
}

///////////////////////////////////////////////////////////////////////////////
/////////////////////////////// END OF FILE ///////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

